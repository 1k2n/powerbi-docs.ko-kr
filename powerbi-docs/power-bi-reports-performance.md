---
title: Power BI 성능 모범 사례
description: 이 문서에서는 Power BI에서 빠르고 신뢰할 수 있는 보고서를 빌드하기 위한 지침을 제공합니다.
author: Bhavik-MSFT
ms.author: bhmerc
ms.reviewer: ''
ms.service: powerbi
ms.subservice: powerbi-service
ms.topic: conceptual
ms.date: 07/30/2018
LocalizationGroup: Reports
ms.openlocfilehash: 2fd0a3d878641264e84a14579901a9685b0f6e8b
ms.sourcegitcommit: 64c860fcbf2969bf089cec358331a1fc1e0d39a8
ms.translationtype: HT
ms.contentlocale: ko-KR
ms.lasthandoff: 11/09/2019
ms.locfileid: "73875097"
---
# <a name="power-bi-performance-best-practices"></a>Power BI 성능 모범 사례

이 문서에서는 Power BI에서 빠르고 신뢰할 수 있는 보고서를 빌드하기 위한 지침을 제공합니다.  

## <a name="choose-an-appropriate-storage-mode-import-directquery"></a>적절한 스토리지 모드를 Import, DirectQuery 중에서 선택합니다.

대부분의 경우 Import 모드는 열 형식 스토리지를 사용하여 압축되는 로컬 캐시 메모리 내 데이터를 활용하여 가장 빠른 속도를 제공하므로 가장 적합합니다. 또한 Import 모드에서는 전체 DAX 기능을 사용할 수 있습니다. 원본 데이터 볼륨이 너무 커서 Power BI 용량에 맞지 않는 경우 DirectQuery(및 복합 모델)를 고려합니다. DirectQuery는 보고서가 로드될 때마다 원본에서 최신 데이터를 가져와야 하는 경우에도 유용합니다. 이러한 요구 사항이 없고 하루에 몇 번 정도만 업데이트되는 데이터만 필요한 경우(예: 회사 데이터 웨어하우스의 데이터) Import가 권장됩니다. DirectQuery 모드에서 사용자는 원본에서 정확히 동일한 데이터를 가져올 것인지 인식하지 못한 상태에서 보고서를 새로 고치려고 할 수 있습니다.      

## <a name="use-filters-to-limit-report-visuals-to-display-only-whats-needed"></a>필터를 사용하여 필요한 것만 표시하도록 보고서 시각적 개체를 제한 

시각적 개체는 표시해야 할 데이터가 많을수록 더 느리게 로드됩니다. 이 원칙은 명확해 보이지만 잊기 쉽습니다. 예를 들어 큰 데이터 세트가 있다고 가정합니다. 데이터 세트 위에 테이블의 행을 사용하여 보고서를 빌드합니다. 최종 사용자는 페이지에서 슬라이서를 사용하여 원하는 행으로 이동합니다. 일반적으로 수십 개 행에만 관심이 있습니다.

흔히 저지르는 실수는 테이블의 기본 보기, 즉 1억 개 이상의 모든 행을 필터링하지 않은 상태로 두는 것입니다. 모든 행의 데이터가 메모리로 로드되고 새로 고칠 때마다 압축 해제됩니다. 이 처리 과정에서 큰 메모리 부하가 생깁니다. 이 문제를 해결하려면 “Top N” 필터를 사용하여 테이블에 표시되는 항목의 최대 수를 줄여야 합니다. 사용자에게 필요한 항목 수보다 큰 최대 수(예: 10,000개)를 설정하면 됩니다. 이에 따라 최종 사용자 환경은 그대로 유지되고 메모리 사용률이 크게 떨어집니다. 또한, 성능도 향상됩니다.

보고서의 모든 시각적 개체에 위와 비슷한 방법이 제안됩니다. 스스로에게 물어보세요. 이 시각적 개체의 모든 데이터가 정말로 필요한가? 최종 사용자 환경에 미치는 영향을 최소화하면서 시각적 개체에 표시되는 데이터 양을 줄이도록 필터링하는 방법이 있는가? 특히 테이블의 경우 비용이 많이 들 수 있습니다.

## <a name="limit-visuals-on-report-pages"></a>보고서 페이지에서 시각적 개체 제한

위의 원칙은 특정 보고서에서 시각적 개체의 수에 동일하게 적용됩니다. 특정 보고서에서 시각적 개체의 수는 필요한 것으로만 제한하는 것이 좋습니다. 드릴스루 페이지는 보고서에 시각적 개체를 넣지 않고 추가 세부 정보를 제공하는 유용한 방법입니다.  

## <a name="optimize-your-model"></a>모델 최적화

몇 가지 모범 사례:

- 가능한 경우, 사용하지 않는 테이블 또는 열은 제거하세요. 
- 높은 카디널리티, 즉 수백만 개의 고유 값이 있는 필드에서 고유 수를 사용하지 않도록 방지합니다.  
- 불필요한 정밀도 및 높은 카디널리티가 있는 필드를 사용하지 않는 단계를 수행합니다. 예를 들어 매우 고유한 날짜/시간 값을 별도의 열(예: 월, 연도, 날짜 등)로 분할할 수 있습니다. 또는 가능한 경우 고정밀 필드에서 반올림을 사용하여 카디널리티를 줄입니다(예: 13.29889 -> 13.3).
- 가능한 경우 문자열 대신 정수를 사용합니다.
- 테이블의 모든 행을 테스트해야 하는 필요한 DAX 함수(예: RANKX)를 주의해야 합니다. 최악의 경우 테이블 크기가 선형적으로 늘어남에 따라 이러한 함수는 런타임 및 메모리 요구 사항을 기하급수적으로 늘릴 수 있습니다.
- DirectQuery를 통해 데이터 원본에 연결할 때 일반적으로 필터링되고 다시 조각화되는 열의 인덱싱을 고려합니다. 인덱싱하면 보고서 응답성이 크게 향상됩니다.  

DirectQuery를 위한 데이터 원본 최적화에 대한 자세한 정보는 [SQL Server 2016 Analysis Services의 DirectQuery](https://blogs.msdn.microsoft.com/analysisservices/2017/04/06/directquery-in-sql-server-2016-analysis-services-whitepaper/)를 참조하세요.

## <a name="directquery-and-live-connection-understand-underlying-data-source-performance"></a>DirectQuery 및 라이브 연결: 기본 데이터 원본 성능의 이해

DirectQuery 또는 라이브 연결 사례에서 사용자가 Power BI 보고서를 방문하는 경우 Power BI에서 쿼리를 실시간으로 기본 데이터 원본으로 보냅니다. 데이터 원본이 쿼리 데이터와 함께 반환되고 나면 보고서가 렌더링됩니다. 결과적으로 보고서 성과는 기본 데이터 원본의 성능에 크게 달라집니다.

이러한 경우 기본 데이터 원본의 성능을 이해하는 것이 중요합니다. 서로 다른 데이터 원본에는 쿼리 성능을 이해하기 위한 다양한 도구가 있습니다. 예를 들어 SQL Server 및 Azure SQL은 쿼리 및 해당 런타임 통계의 기록을 캡처하는 쿼리 저장소를 제공합니다.

DirectQuery 및 라이브 연결을 기반으로 한 Power BI 보고서를 배포할 때 Power BI Desktop에서 최종 사용자가 수행할 사항을 시험해 봅니다. 보고서가 Power BI Desktop에서 느리게 로드된다면 최종 사용자용 서비스에서 느리게 로드될 가능성이 큽니다. 

## <a name="directquery-best-practices"></a>DirectQuery 모범 사례

다음 섹션에서는 DirectQuery를 통한 연결에 대한 일반적인 모범 사례를 설명합니다.

### <a name="db-design-guidance"></a>DB 디자인 지침

- 가능하면 계산 열과 측정값을 원본에 밀어 넣습니다. 원본에 가까울수록 성능이 좋아질 가능성이 커집니다.
- 최적화합니다! 쿼리에 대한 실행 계획을 이해하고 일반적으로 필터링된 열에 대한 인덱스를 추가하는 등의 작업을 수행합니다.

### <a name="modeling-guidance"></a>모델링 지침

- Power BI Desktop에서 시작합니다.
- 쿼리 편집기에서 복잡한 쿼리를 사용하지 않습니다.
- 쿼리 편집기에서 상대 날짜 필터링을 사용하지 않습니다.  
- 처음에는 측정값을 단순하게 유지하고 복잡성을 점차적으로 추가합니다.
- 계산된 열 및 고유 식별자 열에 있는 관계를 사용하지 않습니다.
- 관계에서 “참조 무결성 가정”을 설정해 봅니다. 대부분은 이처럼 설정하면 쿼리 성능이 크게 향상될 수 있습니다.  

### <a name="general"></a>일반

- 먼저 필터를 적용합니다.
- 시각적 개체 간의 상호 작용을 해제하는 것을 고려합니다. 그러면 사용자가 교차 강조 표시할 때 쿼리 부하가 줄어듭니다.
- 위에서 설명한 대로 시각적 개체당 시각적 개체 및 데이터의 수를 제한합니다.
- 행 수준 보안을 사용하도록 설정하면 성능이 상당히 달라질 수 있습니다. 사용자가 가정할 다양한 행 수준 보안 역할을 테스트해야 합니다.
- 장기 실행 쿼리가 시스템 리소스를 독점할 수 없도록 서비스에서 적용하는 쿼리 수준 시간제한이 있습니다. 쿼리가 225초보다 길어지면 시간이 초과되며 시각적 개체 수준 오류가 발생합니다.

## <a name="understand-dashboards-and-query-caches"></a>대시보드 및 쿼리 캐시에 대한 이해

대시보드를 로드할 때 대시보드에 고정된 시각적 개체가 쿼리 캐시에 의해 제공됩니다. 반대로, 보고서를 방문하는 경우 쿼리가 Power BI 서비스(가져오기의 경우) 또는 지정한 데이터 원본(DirectQuery 또는 라이브 연결의 경우) 중 하나의 데이터 원본에 즉시 만들어집니다.  

> [!NOTE]
> 라이브 보고서 타일을 대시보드에 고정하는 경우에는 쿼리 캐시에 의해 제공되지 않으며, 대신 보고서처럼 동작하고 즉시 쿼리를 백 엔드 코어에 만듭니다.

이름에서 알 수 있듯이 쿼리 캐시에서 데이터를 검색하면 데이터 원본을 사용할 때보다 더 일관되며 더 나은 성능이 제공됩니다. 이 기능을 활용하는 한 가지 방법은 사용자의 첫 번째 방문 페이지가 대시보드가 되도록 하는 것입니다. 종종 사용되고 많이 요청되는 시각적 개체를 대시보드에 고정합니다. 이러한 방식으로 대시보드는 적은 용량 부하로 일관된 성능을 제공하는 중요한 “첫 번째 방어선”이 됩니다. 사용자는 보고서를 계속 클릭하여 세부 내용을 살펴볼 수 있습니다.  
 

DirectQuery 및 라이브 연결의 경우 이 쿼리 캐시는 데이터 원본을 쿼리하여 주기적으로 업데이트됩니다. 기본적으로 1시간마다 발생하며, 데이터 세트 설정에서 구성할 수 있습니다. 각 쿼리 캐시 업데이트는 쿼리를 데이터 원본에 전송하여 캐시를 업데이트합니다. 생성된 쿼리의 수는 해당 데이터 원본에 의존하는 대시보드에 고정된 시각적 개체의 수에 따라 달라집니다. 행 수준 보안을 사용하는 경우 각기 다른 보안 컨텍스트에 대해 쿼리가 생성됩니다. 예를 들어 사용자를 범주화하는 두 개의 서로 다른 역할이 있으며, 데이터의 두 가지 서로 다른 보기가 있으면 쿼리 캐시를 새로 고치는 동안 Power BI에서 두 세트의 쿼리를 생성합니다. 

## <a name="understand-custom-visual-performance"></a>사용자 지정 시각적 개체 성능의 이해 

높은 성능을 보장하기 위해 각 사용자 지정 시각적 개체의 역량에 대해 알아보아야 합니다. 제대로 최적화되지 않은 사용자 지정 시각적 개체는 전체 보고서의 성능에 부정적인 영향을 미칠 수 있습니다. 

## <a name="deep-dive-into-query-performance-with-sql-profiler-and-power-bi-desktop"></a>SQL 프로파일러 및 Power BI Desktop을 사용한 쿼리 성능 심층 분석

어떤 시각적 개체가 가장 많은 시간 및 리소스를 차지하는지에 관해 더 자세히 알아보려면 SQL 프로파일러를 Power BI Desktop에 연결하여 쿼리 성능의 전체 보기를 얻을 수 있습니다.

> [!NOTE]
> Power BI Desktop은 진단 포트 연결을 지원합니다. 진단 포트를 사용하면 진단을 위해 다른 도구를 연결하여 추적을 수행할 수 있습니다. *모델을 변경하는 것은 지원되지 않습니다! 모델을 변경하면 손상 및 데이터 손실로 이어질 수 있습니다.*

지침은 다음과 같습니다.
  
1. **SQL Server Profiler 설치 및 Power BI Desktop 실행**

   SQL Server Profiler는 SQL Server Management Studio의 일부로 사용할 수 있습니다.

2. **Power BI Desktop에서 사용 중인 포트 파악**

   관리자 권한으로 명령 프롬프트 또는 PowerShell을 실행합니다. 그런 다음 netstat를 사용하여 Power BI Desktop에서 분석에 사용하는 포트를 찾습니다.

   `> netstat -b -n`

   다음 예와 같이 애플리케이션 및 해당 열린 포트의 목록이 출력됩니다.  

   `TCP    [::1]:55786            [::1]:55830            ESTABLISHED`

   [msmdsrv.exe]

   msmdsrv.exe에서 사용하는 포트를 살펴보고 나중에 사용할 수 있도록 적어 둡니다. 이 경우 55786 포트를 사용합니다.
3. **Power BI Desktop에 SQL Server Profiler 연결**

   - **시작** 메뉴에서 SQL Server Profiler를 시작합니다.
   - **파일** > **새 추적**
   - 서버 유형: Analysis Services
   - 서버 이름: localhost: [위에서 찾은 포트 번호]
   - 다음 화면에서 **실행**을 선택합니다.
   - 이제 SQL 프로파일러는 사용 중이며, Power BI Desktop에서 보내는 쿼리를 적극적으로 프로파일링합니다. 
   - 쿼리가 실행될 때 각각 해당 기간과 CPU 시간을 확인할 수 있습니다. 이 정보를 사용하면 어떤 쿼리에서 병목 현상이 일어나는지 파악할 수 있습니다.  

SQL 프로파일러를 통해 가장 긴 CPU 시간을 사용하는 쿼리를 식별할 수 있습니다. 이러한 쿼리로 인해 성능 병목 현상이 발생할 수 있습니다. 이러한 쿼리를 실행하는 시각적 개체는 지속적인 최적화의 초점이 되어야 합니다.

## <a name="gateway-best-practices"></a>게이트웨이 모범 사례

온-프레미스 데이터 게이트웨이는 온-프레미스 데이터를 사용한 Power BI 서비스를 연결하기 위한 좋은 도구입니다. 동시에 계획이 부실하면 보고서 성능에서 병목 현상이 일어날 수 있습니다. 이는 모든 쿼리 및 쿼리 응답이 게이트웨이를 통해 전달되는 DirectQuery/라이브 연결 데이터 세트에서는 특히 그러합니다. 다음은 고성능 게이트웨이를 보장하기 위한 몇 가지 모범 사례입니다. 

- 개인 모드에 반대로 **엔터프라이즈 모드를 사용**합니다.
- **게이트웨이에 추천되는 하드웨어 사양** - 8개 CPU 코어, 16GB RAM
- **모니터링 설정** – 게이트웨이 컴퓨터에서 성능 모니터링을 설정하여 게이트웨이가 오버로드 및 병목 상태가 되는지 여부를 파악합니다. 자세한 내용은 [온-프레미스 데이터 게이트웨이 문제 해결](service-gateway-onprem-tshoot.md)을 참조하세요.
- **강화 또는 규모 확장** - 게이트웨이가 실제로 병목 상태가 되는 경우, 강화(즉, 더 많은 CPU와 RAM을 사용하는 더 강력한 머신으로 게이트웨이를 이동) 또는 규모 확장(예: 다른 게이트웨이로 데이터 세트를 분할)을 고려합니다. 
- **별도 가져오기 vs. DirectQuery** – 규모 확장의 경우 가져오기를 담당하는 게이트웨이와 DirectQuery를 담당하는 게이트웨이의 분리를 고려합니다.

## <a name="network-latency"></a>네트워크 대기 시간

네트워크 대기 시간은 Power BI 서비스 연결에 대한 요청 및 전달할 응답에 필요한 시간이 늘어나면 보고서 성능에 영향을 줄 수 있습니다. Power BI의 테넌트는 특정 지역에 할당됩니다. powerbi.com으로 이동하고 오른쪽 위에 있는 **?** 를 선택한 다음 **Power BI 정보**를 선택하면 테넌트의 “홈” 영역을 볼 수 있습니다. 테넌트의 사용자가 Power BI 서비스에 액세스하는 경우 해당 요청은 항상 이 영역에 라우팅됩니다. 요청이 Power BI 서비스에 도달하면 서비스에서 추가 요청을 기본 데이터 원본 또는 게이트웨이와 같은 대상으로 보낼 수 있습니다. 또한 네트워크 대기 시간의 영향도 받습니다.

[Azure 속도 테스트](https://azurespeedtest.azurewebsites.net/)와 같은 도구는 클라이언트와 Azure 지역 간의 네트워크 대기 시간을 표시합니다. 일반적으로 네트워크 대기 시간의 영향을 최소화하려면 데이터 원본, 게이트웨이 및 Power BI 클러스터를 최대한 가깝게 유지해야 합니다. 네트워크 대기 시간이 문제가 되는 경우 게이트웨이 및 데이터 원본을 가상 머신에 배치하여 사용자 Power BI 클러스터에 더 가깝게 설치해 보세요.

네트워크 대기 시간을 더욱 개선하려면 클라이언트와 Azure 데이터 센터 간에 더 빠르고 더 안정적인 네트워크 연결을 만들 수 있는 [Azure ExpressRoute](https://azure.microsoft.com/services/expressroute/) 사용을 고려합니다.

## <a name="next-steps"></a>다음 단계

- [Power BI 엔터프라이즈 배포 계획](https://aka.ms/pbienterprisedeploy) - Power BI의 대규모 배포에 대한 전반적인 지침 사용
- [SQL Server 2016 Analysis Services의 DirectQuery](https://blogs.msdn.microsoft.com/analysisservices/2017/04/06/directquery-in-sql-server-2016-analysis-services-whitepaper/)
- [[YouTube] Power BI에서 빠르고 신뢰할 수 있는 보고서 빌드](https://www.youtube.com/watch?v=GhiJABR7XX0)
- [[YouTube] Power BI 엔터프라이즈 배포](https://www.youtube.com/watch?v=K-zEWICvICM)
